/*
*  Project: Chroma Gallery
*  Description: A Jquery Gallery that takes the color of the images
*  Author: Lucas Lara Marotta - codecrafting.net
*  License: under the MIT license: http://www.opensource.org/licenses/mit-license.php
*
* Color Thief v2.0
* by Lokesh Dhakar - http://www.lokeshdhakar.com
*
* License
* -------
* Copyright 2011, 2015 Lokesh Dhakar
* Released under the MIT license
* https://raw.githubusercontent.com/lokesh/color-thief/master/LICENSE
 */

!function(t,e,i,n){function r(){for(var t,e=["transform","msTransform","webkitTransform","mozTransform","oTransform"],n=0;n<e.length;n++)if("undefined"!=typeof i.body.style[e[n]]){t=e[n];break}switch(t){case"msTransform":return"-ms-";case"webkitTransform":return"-webkit-";case"mozTransform":return"-moz-";case"oTransform":return"-o-";default:return""}}function s(t){var n,r=i.createElement("div");return r.style.color=t,i.body.appendChild(r),n=e.getComputedStyle(r).color,i.body.removeChild(r),n}function o(t){return"string"==typeof t?t.split(/[?#]/)[0].split("/").pop():n}function a(t){for(var e in t)if(t.hasOwnProperty(e)){var i=t[e];switch(e){case"color":"string"!=typeof i&&(t[e]=b[e]);break;case"maxColumns":var n=parseInt(i,10);n!=i?t[e]=b[e]:0==n&&(t[e]=b[e]);break;case"items":null===i||Array.isArray(i)||(t[e]=[]);break;case"dof":"boolean"==typeof i&&Modernizr.cssfilters||(t[e]=b[e]);break;case"screenOpacity":"number"!=typeof i&&(t[e]=b[e]);break;case"lazyLoad":"boolean"!=typeof i&&(t[e]=b[e]);break;case"gridMargin":var n=parseInt(i,10);n!=i&&(t[e]=b[e]);break;case"fullscreen":"boolean"!=typeof i&&(t[e]=b[e]),Modernizr.fullscreen||(t[e]=!1);break;case"easing":"string"!=typeof i&&(t[e]=b[e]);break;case"onLoad":"function"!=typeof i&&(t[e]=b[e]);break;case"onOpen":"function"!=typeof i&&(t[e]=b[e]);break;case"onClose":"function"!=typeof i&&(t[e]=b[e]);break;case"onNext":"function"!=typeof i&&(t[e]=b[e]);break;case"onPrevious":"function"!=typeof i&&(t[e]=b[e]);break;case"onFullscreen":"function"!=typeof i&&(t[e]=b[e])}}}function c(e,i){var n=this;this.$el=t(e),this.isLoaded=!1,this.grid=null,this.settings=t.extend({},b,i),a(this.settings),"chroma"!=this.settings.color&&(this.settings.color=s(this.settings.color)),null==y&&(y=new l,this.$el.append("<span class='chrg-loadicon chrgi-image'></span>"),setTimeout(function(){n.$el.find(".chrg-loadicon").remove()},50)),this._init()}function l(){this.colorThief=new u,this.settings=null,this.isOpen=!1,this.isFullscreen=!1,this.curItem=null,this.curGallery=null,this.init()}var h=function(t){this.canvas=i.createElement("canvas"),this.context=this.canvas.getContext("2d"),i.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)};h.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},h.prototype.update=function(t){this.context.putImageData(t,0,0)},h.prototype.getPixelCount=function(){return this.width*this.height},h.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},h.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var u=function(){};if(u.prototype.getColor=function(t,e){var i=this.getPalette(t,5,e),n=i[0];return n},u.prototype.getPalette=function(t,e,i){"undefined"==typeof e&&(e=10),("undefined"==typeof i||1>i)&&(i=10);for(var n,r,s,o,a,c=new h(t),l=c.getImageData(),u=l.data,d=c.getPixelCount(),f=[],p=0;d>p;p+=i)n=4*p,r=u[n+0],s=u[n+1],o=u[n+2],a=u[n+3],a>=125&&(r>250&&s>250&&o>250||f.push([r,s,o]));var m=g.quantize(f,e),v=m?m.palette():null;return c.removeCanvas(),v},!d)var d={map:function(t,e){var i={};return e?t.map(function(t,n){return i.index=n,e.call(i,t)}):t.slice()},naturalOrder:function(t,e){return e>t?-1:t>e?1:0},sum:function(t,e){var i={};return t.reduce(e?function(t,n,r){return i.index=r,t+e.call(i,n)}:function(t,e){return t+e},0)},max:function(t,e){return Math.max.apply(null,e?d.map(t,e):t)}};var g=function(){function t(t,e,i){return(t<<2*c)+(e<<c)+i}function e(t){function e(){i.sort(t),n=!0}var i=[],n=!1;return{push:function(t){i.push(t),n=!1},peek:function(t){return n||e(),void 0===t&&(t=i.length-1),i[t]},pop:function(){return n||e(),i.pop()},size:function(){return i.length},map:function(t){return i.map(t)},debug:function(){return n||e(),i}}}function i(t,e,i,n,r,s,o){var a=this;a.r1=t,a.r2=e,a.g1=i,a.g2=n,a.b1=r,a.b2=s,a.histo=o}function n(){this.vboxes=new e(function(t,e){return d.naturalOrder(t.vbox.count()*t.vbox.volume(),e.vbox.count()*e.vbox.volume())})}function r(e){var i,n,r,s,o=1<<3*c,a=new Array(o);return e.forEach(function(e){n=e[0]>>l,r=e[1]>>l,s=e[2]>>l,i=t(n,r,s),a[i]=(a[i]||0)+1}),a}function s(t,e){var n,r,s,o=1e6,a=0,c=1e6,h=0,u=1e6,d=0;return t.forEach(function(t){n=t[0]>>l,r=t[1]>>l,s=t[2]>>l,o>n?o=n:n>a&&(a=n),c>r?c=r:r>h&&(h=r),u>s?u=s:s>d&&(d=s)}),new i(o,a,c,h,u,d,e)}function o(e,i){function n(t){var e,n,r,s,o,a=t+"1",l=t+"2",h=0;for(c=i[a];c<=i[l];c++)if(p[c]>f/2){for(r=i.copy(),s=i.copy(),e=c-i[a],n=i[l]-c,o=n>=e?Math.min(i[l]-1,~~(c+n/2)):Math.max(i[a],~~(c-1-e/2));!p[o];)o++;for(h=m[o];!h&&p[o-1];)h=m[--o];return r[l]=o,s[a]=r[l]+1,[r,s]}}if(i.count()){var r=i.r2-i.r1+1,s=i.g2-i.g1+1,o=i.b2-i.b1+1,a=d.max([r,s,o]);if(1==i.count())return[i.copy()];var c,l,h,u,g,f=0,p=[],m=[];if(a==r)for(c=i.r1;c<=i.r2;c++){for(u=0,l=i.g1;l<=i.g2;l++)for(h=i.b1;h<=i.b2;h++)g=t(c,l,h),u+=e[g]||0;f+=u,p[c]=f}else if(a==s)for(c=i.g1;c<=i.g2;c++){for(u=0,l=i.r1;l<=i.r2;l++)for(h=i.b1;h<=i.b2;h++)g=t(l,c,h),u+=e[g]||0;f+=u,p[c]=f}else for(c=i.b1;c<=i.b2;c++){for(u=0,l=i.r1;l<=i.r2;l++)for(h=i.g1;h<=i.g2;h++)g=t(l,h,c),u+=e[g]||0;f+=u,p[c]=f}return p.forEach(function(t,e){m[e]=f-t}),n(a==r?"r":a==s?"g":"b")}}function a(t,i){function a(t,e){for(var i,n=1,r=0;h>r;)if(i=t.pop(),i.count()){var s=o(c,i),a=s[0],l=s[1];if(!a)return;if(t.push(a),l&&(t.push(l),n++),n>=e)return;if(r++>h)return}else t.push(i),r++}if(!t.length||2>i||i>256)return!1;var c=r(t),l=0;c.forEach(function(){l++});var g=s(t,c),f=new e(function(t,e){return d.naturalOrder(t.count(),e.count())});f.push(g),a(f,u*i);for(var p=new e(function(t,e){return d.naturalOrder(t.count()*t.volume(),e.count()*e.volume())});f.size();)p.push(f.pop());a(p,i-p.size());for(var m=new n;p.size();)m.push(p.pop());return m}var c=5,l=8-c,h=1e3,u=.75;return i.prototype={volume:function(t){var e=this;return(!e._volume||t)&&(e._volume=(e.r2-e.r1+1)*(e.g2-e.g1+1)*(e.b2-e.b1+1)),e._volume},count:function(e){var i=this,n=i.histo;if(!i._count_set||e){var r,s,o,a=0;for(r=i.r1;r<=i.r2;r++)for(s=i.g1;s<=i.g2;s++)for(o=i.b1;o<=i.b2;o++)index=t(r,s,o),a+=n[index]||0;i._count=a,i._count_set=!0}return i._count},copy:function(){var t=this;return new i(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(e){var i=this,n=i.histo;if(!i._avg||e){var r,s,o,a,l,h=0,u=1<<8-c,d=0,g=0,f=0;for(s=i.r1;s<=i.r2;s++)for(o=i.g1;o<=i.g2;o++)for(a=i.b1;a<=i.b2;a++)l=t(s,o,a),r=n[l]||0,h+=r,d+=r*(s+.5)*u,g+=r*(o+.5)*u,f+=r*(a+.5)*u;i._avg=h?[~~(d/h),~~(g/h),~~(f/h)]:[~~(u*(i.r1+i.r2+1)/2),~~(u*(i.g1+i.g2+1)/2),~~(u*(i.b1+i.b2+1)/2)]}return i._avg},contains:function(t){var e=this,i=t[0]>>l;return gval=t[1]>>l,bval=t[2]>>l,i>=e.r1&&i<=e.r2&&gval>=e.g1&&gval<=e.g2&&bval>=e.b1&&bval<=e.b2}},n.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var e=this.vboxes,i=0;i<e.size();i++)if(e.peek(i).vbox.contains(t))return e.peek(i).color;return this.nearest(t)},nearest:function(t){for(var e,i,n,r=this.vboxes,s=0;s<r.size();s++)i=Math.sqrt(Math.pow(t[0]-r.peek(s).color[0],2)+Math.pow(t[1]-r.peek(s).color[1],2)+Math.pow(t[2]-r.peek(s).color[2],2)),(e>i||void 0===e)&&(e=i,n=r.peek(s).color);return n},forcebw:function(){var t=this.vboxes;t.sort(function(t,e){return d.naturalOrder(d.sum(t.color),d.sum(e.color))});var e=t[0].color;e[0]<5&&e[1]<5&&e[2]<5&&(t[0].color=[0,0,0]);var i=t.length-1,n=t[i].color;n[0]>251&&n[1]>251&&n[2]>251&&(t[i].color=[255,255,255])}},{quantize:a}}(),f="chromaGallery",p=t(e),m=t("body"),v=350,y=null,x=r(),b=(e.location.protocol+"//"+e.location.host+e.location.pathname,{color:"chroma",maxColumns:4,items:null,dof:!1,screenOpacity:.95,lazyLoad:!0,gridMargin:7,fullscreen:!0,easing:"easeInOutQuart",onLoad:function(){},onOpen:function(){},onClose:function(){},onNext:function(){},onPrev:function(){},onFullscreen:function(){}}),w={next:39,prev:37,fullscreen:70,close:27};t.extend(c.prototype,{_init:function(){var e=this;this.$el.hasClass("chroma-gallery")||this.$el.addClass("chroma-gallery"),this.$el.show(),setTimeout(function(){var i,r=0;e._createGrid(),e._setEvents(),i=e.grid.find("img"),i.one({load:function(){var i=t(this);if(this.naturalWidth===n||this.naturalWidth!==n&&0==this.naturalWidth)i.css({height:"200px",opacity:"0"}).parent().attr("data-isloaded","false").css({cursor:"default",opacity:"1"}).find(".chrg-description").css({opacity:"1"}).find("p").append("<span class='chrgi-image'></span><br>"+o(i.attr("src"))+" failed to load");else{var r=i.attr("alt")!==n?i.attr("alt").substring(0,144):"";i.parent().attr("data-isloaded","true").css({opacity:"1"}).find("p").append(r)}e.grid.masonry("layout")},error:function(){var i=t(this);i.css({height:"200px",opacity:"0"}).parent().attr("data-isloaded","false").css({cursor:"default",opacity:"1"}).find(".chrg-description").css({opacity:"1"}).find("p").append("<span class='chrgi-image'></span><br>"+o(i.attr("src"))+" failed to load"),e.grid.masonry("layout")}}).each(function(n){var s=t(this),o=e.settings.lazyLoad?150*r:0;r++,this.complete&&(e.settings.lazyLoad?setTimeout(function(){s.load()},o):s.load()),n+1==i.length&&(e.isLoaded=!0,e.$el.trigger("chrg.load"))})},50)},_getColumnWidth:function(t){var e,i=this.$el.width();return e=400>=i?2:i/this.settings.maxColumns>=200?Math.min(this.settings.maxColumns,t):Math.floor(i/200),this.settings.gridMargin>0?100/e*((i-e*this.settings.gridMargin)/i):100/e},_createGrid:function(){var t=this;if(this.settings.items){var e=this._getColumnWidth(this.settings.items.length);this.$el.html("<div class='chrg-grid'></div>"),this.grid=this.$el.find(".chrg-grid");for(var i=0;i<this.settings.items.length;i++)this.settings.items[i].src&&this.settings.items[i].alt&&this.settings.items[i].largesrc&&this.grid.append("<div class='chrg-item chrg-no-select' style='width:"+e+"%; margin-bottom:"+this.settings.gridMargin+"px;'><img src='"+this.settings.items[i].src+"' alt='"+this.settings.items[i].alt+"' data-largesrc='"+this.settings.items[i].largesrc+"'/><div class='chrg-description'><p></p></div></div>")}else{var e=this._getColumnWidth(this.$el.find("img").length);this.$el.append("<div class='chrg-grid'></div>"),this.grid=this.$el.find(".chrg-grid"),this.$el.find("img").wrap("<div class='chrg-item chrg-no-select' style='width:"+e+"%; margin-bottom:"+this.settings.gridMargin+"px;'></div>").parent().append("<div class='chrg-description'><p></p></div>"),this.grid.append(this.$el.find(".chrg-item"))}this.grid.masonry({itemSelector:".chrg-item",gutter:t.settings.gridMargin,percentPosition:!0})},_reloadGrid:function(){var t=this._getColumnWidth(this.grid.find(".chrg-item").length);this.grid.find(".chrg-item").css("width",t+"%"),this.grid.masonry("layout")},_setEvents:function(){var i=this;this.grid.find(".chrg-item").on("click",function(){i.openImg(t(this).index())}),this.$el.on("chrg.load",function(){i.settings.onLoad.call(i.$el)}).on("chrg.openImg",function(){i.settings.onOpen.call(i.$el)}).on("chrg.closeImg",function(){i.settings.onClose.call(i.$el)}).on("chrg.next",function(){i.settings.onNext.call(i.$el)}).on("chrg.prev",function(){i.settings.onPrev.call(i.$el)}).on("chrg.fullscreen",function(){i.settings.onFullscreen.call(i.$el)}),p.resize(function(){i.isLoaded&&i._reloadGrid()}),e.addEventListener("orientationchange",function(){i.isLoaded&&i._reloadGrid()})},openImg:function(e){if(!y.isOpen&&this.isLoaded){var i=t(this.grid.find(".chrg-item").get(e));i.length>0&&i.data("isloaded")&&(y.curGallery=this.$el,y.curItem=i,y.qtdItems=this.grid.find(".chrg-item").length,y.settings={color:this.settings.color,dof:this.settings.dof,screenOpacity:this.settings.screenOpacity,fullscreen:this.settings.fullscreen,easing:this.settings.easing},y.openImg())}},closeImg:function(){y.isOpen&&y.closeImg()},goTo:function(e){if(y.isOpen&&!y.lock){var i=t(this.grid.find(".chrg-item").get(e));i.length>0&&i.data("isloaded")?y.goTo(i):console.info("[CHROMA GALLERY]: Item is not loaded")}},next:function(){y.isOpen&&!y.lock&&y.next()},prev:function(){y.isOpen&&!y.lock&&y.prev()}}),t.extend(l.prototype,{init:function(){m.append("<div class='chroma-screen'><div class='chrg-bg'></div><div class='chrg-wrap'><div class='chrg-content'><div class='chrg-imgwrap' data-isloaded='false'></div></div><div class='chrg-ui'><p class='chrg-index'></p><button class='chrgi-close chrg-no-select'></button><button class='chrg-fullscreen chrgi-maximize chrg-no-select'></button><button class='chrgi-next chrg-no-select'></button><button class='chrgi-previous chrg-no-select'></button><div class='chrg-loader'><div class='chrg-loader-line-wrap-wrap'><div class='chrg-loader-line-wrap'></div></div><div class='chrg-loader-line-wrap-wrap'><div class='chrg-loader-line-wrap'></div></div><div class='chrg-loader-line-wrap-wrap'><div class='chrg-loader-line-wrap'></div></div><div class='chrg-loader-line-wrap-wrap'><div class='chrg-loader-line-wrap'></div></div><div class='chrg-loader-line-wrap-wrap'><div class='chrg-loader-line-wrap'></div></div></div></div></div></div>"),this.$screen=m.find(".chroma-screen"),this.$imgWrap=this.$screen.find(".chrg-imgwrap"),this.$fullscreenBtn=this.$screen.find(".chrg-fullscreen"),this.$loader=this.$screen.find(".chrg-loader"),this.$ui=this.$screen.find(".chrg-ui"),this.$bg=this.$screen.find(".chrg-bg"),this.$index=this.$screen.find(".chrg-index"),this.qtdItems=null,this.lock=!1,this.setEvents()},setEvents:function(){var t=this;this.$screen.find(".chrgi-close").on("click",function(e){e.stopPropagation(),t.closeImg()}),this.$screen.find(".chrgi-next").on("click",function(e){e.stopPropagation(),t.next()}),this.$imgWrap.on("click",function(t){t.stopPropagation()}),this.$screen.find(".chrgi-previous").on("click",function(e){e.stopPropagation(),t.prev()}),p.resize(function(){t.resizeImgWrap()}),e.addEventListener("orientationchange",function(){t.resizeImgWrap()}),p.keydown(function(e){if(t.isOpen)switch(e.keyCode){case w.next:t.next();break;case w.prev:t.prev();break;case w.close:t.closeImg()}}),this.$screen.find(".chrg-wrap").on("click",function(){t.closeImg()}),Modernizr.fullscreen&&this.$fullscreenBtn.on("click",function(e){e.stopPropagation(),t.toggleFullscreen()})},toggleFullscreen:function(){i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement?(this.isFullscreen=!1,this.$fullscreenBtn.removeClass("chrgi-minimize").addClass("chrgi-maximize"),i.exitFullscreen?i.exitFullscreen():i.msExitFullscreen?i.msExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.webkitExitFullscreen&&i.webkitExitFullscreen()):(this.isFullscreen=!0,this.$fullscreenBtn.removeClass("chrgi-maximize").addClass("chrgi-minimize"),this.curGallery.trigger("chrg.fullscreen"),i.documentElement.requestFullscreen?i.documentElement.requestFullscreen():i.documentElement.msRequestFullscreen?i.documentElement.msRequestFullscreen():i.documentElement.mozRequestFullScreen?i.documentElement.mozRequestFullScreen():i.documentElement.webkitRequestFullscreen&&i.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT))},resizeImgWrap:function(){if(this.isOpen){var t,e={w:this.curItem.width(),h:this.curItem.height()},i=Math.min(.92*p.width()/e.w,.92*p.height()/e.h),n={x:(p.width()-e.w*i)/2,y:(p.height()-e.h*i)/2};t={width:e.w*i,height:e.h*i},t[x+"transform"]=Modernizr.csstransforms3d?"translate3d("+n.x+"px,"+n.y+"px,0) scale(1)":"translate("+n.x+"px,"+n.y+"px) scale(1)",this.$imgWrap.css(t)}},loadImg:function(t){var e=this,i=e.curItem;if(this.curItem.data("fullload")===n){var r=new Image;Modernizr.cssanimations&&this.$loader.show(),r.onload=function(){i==e.curItem&&(e.$imgWrap.append(this),e.curItem.attr("data-fullload",!0),Modernizr.cssanimations&&e.$loader.hide())},r.onerror=function(){e.$loader.hide()},r.src=t.data("largesrc")}else this.$imgWrap.append("<img src='"+t.data("largesrc")+"'/>")},getRGBColor:function(t){if("chroma"==this.settings.color){if(t.data("color")===n){var e,i=this.colorThief.getColor(t[0]);return e=i&&3==i.length?"rgb("+i[0]+","+i[1]+","+i[2]+")":"rgb(0,0,0)",t.attr("data-color",e),e}return t.data("color")}return this.settings.color},openImg:function(){if(!this.lock){this.lock=!0;var t,e,i=this,n=this.curItem.offset(),r=this.getRGBColor(this.curItem.find("img")),s={width:.92*p.width(),height:.92*p.height()},o=this.curItem.find("img").clone();this.settings.fullscreen?this.$fullscreenBtn.show():this.$fullscreenBtn.hide(),t=Math.min(s.width/this.curItem.width(),s.height/this.curItem.height()),e={x:n.left-p.scrollLeft(),y:n.top-p.scrollTop(),width:this.curItem.width()*t,height:this.curItem.height()*t},this.$index.html(this.curItem.index()+1+" / "+this.qtdItems),this.$imgWrap.css({width:e.width,height:e.height}).html(""),Modernizr.csstransforms3d?this.$imgWrap.css(x+"transform","translate3d("+e.x+"px,"+e.y+"px,0) scale("+1/t+")"):this.$imgWrap.css(x+"transform","translate("+e.x+"px,"+e.y+"px) scale("+1/t+")"),this.settings.dof&&(m.wrapInner("<div class='chrg-dof-body'></div>"),this.$screen.appendTo(m)),e.x=(p.width()-e.width)/2,e.y=(p.height()-e.height)/2,this.$imgWrap.addClass("chrg-animation chrg-easing-"+this.settings.easing),this.$imgWrap.append(o),this.$screen.show(),this.isOpen=!0,setTimeout(function(){i.curItem.css("visibility","hidden"),i.$ui.css("opacity",.01).css("opacity",1),i.$bg.css("opacity",.01).css({opacity:i.settings.screenOpacity,"background-color":r}),Modernizr.csstransforms3d?i.$imgWrap.css(x+"transform","translate3d("+e.x+"px,"+e.y+"px,0) scale(1)"):i.$imgWrap.css(x+"transform","translate("+e.x+"px,"+e.y+"px) scale(1)"),setTimeout(function(){i.settings.dof&&m.find(".chrg-dof-body").addClass("chrg-dof-effect"),i.$imgWrap.removeClass("chrg-animation"),i.lock=!1,i.curGallery.trigger("chrg.openImg"),i.loadImg(o)},v+50)},80)}},closeImg:function(){if(this.isOpen&&!this.lock){this.lock=!0;var t=this,e=this.curItem.width()/this.$imgWrap.width(),i=this.curItem.offset(),n={x:i.left-p.scrollLeft(),y:i.top-p.scrollTop()};this.$imgWrap.addClass("chrg-animation").find("img:nth-child(2)").hide(),this.$ui.css("opacity",""),this.$bg.css("opacity",""),this.settings.dof&&m.find(".chrg-dof-body").contents().unwrap(),setTimeout(function(){Modernizr.csstransforms3d?t.$imgWrap.css(x+"transform","translate3d("+n.x+"px,"+n.y+"px,0) scale("+e+")"):t.$imgWrap.css(x+"transform","translate("+n.x+"px,"+n.y+"px) scale("+e+")"),setTimeout(function(){t.curItem.css("visibility",""),t.$imgWrap.attr("class","chrg-imgwrap"),t.curGallery.trigger("chrg.closeImg"),setTimeout(function(){t.curItem=null,t.$screen.hide(),Modernizr.fullscreen&&t.isFullscreen&&t.toggleFullscreen(),t.curGallery=null,t.qtdItems=null,t.isOpen=!1,t.lock=!1},50)},v+50)},50)}},next:function(){if(!this.lock){this.lock=!0;var t=this.curItem.index(),e=t+1==this.curGallery.find(".chrg-item").length?0:t+1,i=this.curGallery.find(".chrg-item:eq("+e+")");i.data("isloaded")?(this.goTo(i),this.curGallery.trigger("chrg.next")):(i=i.next(".chrg-item[data-isloaded='true']"),0!=i.length?(this.goTo(i),this.curGallery.trigger("chrg.next")):(console.info("[CHROMA GALLERY]: There are only one item available"),this.lock=!1))}},prev:function(){if(!this.lock){this.lock=!0;var t=this.curItem.index(),e=0==t?this.curGallery.find(".chrg-item").length-1:t-1,i=this.curGallery.find(".chrg-item:eq("+e+")");i.data("isloaded")?(this.goTo(i),this.curGallery.trigger("chrg.prev")):(i=i.prev(".chrg-item[data-isloaded='true']"),0!=i.length?(this.goTo(i),this.curGallery.trigger("chrg.prev")):(console.info("[CHROMA GALLERY]: There are only one item available"),this.lock=!1))}},goTo:function(t){var e,i,n,r=t.find("img").clone(),s=this.getRGBColor(t.find("img"));e=Math.min(.92*p.width()/t.width(),.92*p.height()/t.height()),i={x:(p.width()-t.width()*e)/2,y:(p.height()-t.height()*e)/2},n={width:t.width()*e,height:t.height()*e},n[x+"transform"]=Modernizr.csstransforms3d?"translate3d("+i.x+"px,"+i.y+"px,0) scale(1)":"translate("+i.x+"px,"+i.y+"px) scale(1)",this.curItem.css("visibility","visible"),this.$imgWrap.css(n).html(r),this.$bg.css({"background-color":s}),this.curItem=t,this.curItem.css("visibility","hidden"),this.$index.html(this.curItem.index()+1+" / "+this.qtdItems),this.loadImg(r),this.lock=!1}}),t.fn[f]=function(e){var i=arguments;if(e===n||"object"==typeof e)return this.each(function(){t.data(this,"plugin_"+f)||t.data(this,"plugin_"+f,new c(this,e))});if("string"==typeof e&&"_"!==e[0]&&"init"!==e){var r;return this.each(function(){var n=t.data(this,"plugin_"+f);n instanceof c&&"function"==typeof n[e]&&(r=n[e].apply(n,Array.prototype.slice.call(i,1))),"destroy"===e&&t.data(this,"plugin_"+f,null)}),r!==n?r:this}}}(jQuery,window,document);